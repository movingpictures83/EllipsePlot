#activeX=c(-0.412735751106, 0.117852965618, 0.0927351053697, -0.0737627835893, 0.182049532162, 0.00272522329423, -0.158709685977, -0.0731101225638, -0.108879795387, 0.124835998673, 0.0502514086943, 0.0669634227371, 0.0412979088456, 0.13761046324, 0.173221418616, 0.07333432645, 0.0548157221328, -0.122655273759, 0.125614701502, 0.0532447746971, 0.129317799866)
#activeY=c(0.260377466156, -0.0693349534804, -0.0657294104483, -0.126343418287, -0.0352279498065, -0.0836376683922, 0.0021357868789, 0.0316566957678, 0.0304115598583, -0.0367273843455, 0.000699443898036, -0.0743833748783, -0.0991677353199, -0.0381258915979, -0.0703097171459, -0.0166368189494, -0.0164772252344, -0.0405748826129, -0.00198178438081, -0.0915592828067, -0.0789665245691)
#activeZ=c(-0.0516419022857, -0.0962626396275, -0.113520299889, 0.018457104173, -0.284009076556, -0.0966888002573, -0.140847332226, -0.192487413426, -0.183171026001, -0.160285456114, -0.215274052885, -0.0905598250992, -0.0801409136361, -0.136200205298, -0.187116715142, -0.187811254072, -0.232527497634, -0.14664477921, -0.296204987017, -0.0857169122863, -0.128302544738)
#formerX=c(-0.41995688103, 0.0653535675373, -0.378369160333, -0.00720149816688, -0.257316575579, -0.123613320501, -0.143063191756, -0.258772491866, 0.0193869920036, 0.0538277748063, 0.0519309037009, -0.306711526134, 0.0424247700571, 0.0355649251383, 0.0642179860075, 0.046502977526, -0.135770953968, -0.316813693927, -0.0876701934823, 0.0669159042575, 0.0409838789997, -0.314419971467, 0.0239391688577, -0.134176756121)
#formerY=c(0.47220539248, -0.10939085119, 0.151659320824, -0.101930367262, -0.0102669353733, -0.0519668605072, -0.0620914610481, -0.00315336589822, -0.115343339504, -0.114400289615, -0.110796473887, 0.0906715500829, -0.127672159621, -0.13347654779, -0.112492256388, -0.109886313686, -0.087629582998, 0.0909936060021, -0.0989141329216, -0.0975637669641, -0.135338981958, 0.00749999139462, -0.121347243896, -0.102413403354)
#formerZ=c(-0.0785732800696, 0.0829983916908, -0.0558470967109, 0.142478541772, 0.112704462859, 0.0750104646943, 0.155193839431, -0.0467858057203, 0.145647983651, 0.142119949784, 0.14531501942, 0.0281168313309, 0.0795759205255, 0.0668323888814, 0.138939138392, 0.123698954914, 0.160824582066, 0.0487073055751, 0.121888692749, 0.105202229113, 0.0505348331838, 0.0992438793484, 0.119258189917, 0.0973718028089)
#neverX=c(0.312125529169, -0.22432046978, 0.331506840536, 0.327341954515, 0.331846817134, 0.113366437995, 0.332483460512, 0.317204398093, 0.05523503775)
#neverY=c(0.230002829479, 0.0413145844856, 0.271088493471, 0.241354007376, 0.261983750827, 0.0449889147535, 0.26960062263, 0.233539181448, 0.0190751583036)
#neverZ=c(0.117687744368, 0.118226030787, 0.0736047499104, 0.0945862611648, 0.105097146178, 0.149959067731, 0.113489334605, 0.102439928905, 0.151409045972)

library(ggplot2)
library(data.table)



dyn.load(paste("RPluMA", .Platform$dynlib.ext, sep=""))
source("RPluMA.R")

library(phyloseq)
library(microbiome)

input <- function(inputfile) {
  pfix = prefix()
  if (length(pfix) != 0) {
     pfix <- paste(pfix, "/", sep="")
  }
  print(pfix)
  parameters <- read.table(inputfile, as.is=T);
  parameters <- parameters[,1]
  

  #xx <- read.table(paste(pfix,parameters[2],sep="/"))
  #print(xx[,1])

  ggdat <<- rbind()
  for (i in 1:length(parameters)) {
     coord <- read.table(paste(pfix,parameters[i],sep="/"))
     dat <- data.frame(X=coord[,1], Y=coord[,2], group_id=rep(i,length(coord[,1])))
     ggdat <<- rbind(ggdat, dat)
  }
  print(ggdat)
}

run <- function() {
   ggdat$group_id <<- as.factor(ggdat$group_id)
}

output <- function(outputfile) {
y <- ggplot(ggdat) +
  geom_point(aes(x=X,y=Y,color=group_id),size=1) + #
  stat_ellipse(aes(x=X,y=Y,color=group_id)) + #, linetype = 2
	  theme(legend.position='none')
ggsave(paste(outputfile, "pdf", sep="."), y, width=10, dpi=300)
write.csv(y$data, paste(outputfile, "csv", sep="."))
}

#dat1 <- data.frame(X=activeY,Y=activeZ,group_id=rep(1,21),color_id=rep("#0000FF",21))
#dat2 <- data.frame(X=formerY,Y=formerZ,group_id=rep(2,24),color_id=rep("#FFFF00",24))
#dat3 <- data.frame(X=neverY,Y=neverZ,group_id=rep(4,9), color_id=rep("111111", 9))
#ggdat <- rbind(dat1,dat2,dat3)
#ggdat$group_id <- as.factor(ggdat$group_id)
#ggdat$color_id <- as.factor(ggdat$color_id)
#ggplot(ggdat) +
#  geom_point(aes(x=X,y=Y,color=group_id),size=1) + #
#  stat_ellipse(aes(x=X,y=Y,color=group_id)) + #, linetype = 2
#  theme(legend.position='none') +
#	  scale_color_manual(values=c("#56B4E9", "#E69F00", "#999999"))+xlab("PC2")+ylab("PC3")
